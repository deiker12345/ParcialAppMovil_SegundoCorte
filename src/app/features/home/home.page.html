<ion-header>
  <ion-toolbar>
    <ion-title>Tinder App</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="goToChat()">
        <ion-icon name="chatbubbles-outline"></ion-icon>
      </ion-button>
      <ion-button (click)="goToProfile()">
        <ion-icon name="person-circle-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="home-content">
  
  <!-- Cards Stack Container -->
  <div class="cards-stack" *ngIf="profiles.length > 0; else noProfiles">
    <ng-container *ngFor="let profile of visibleProfiles; let i = index">
      <app-swipe-card 
        [user]="profile"
        [isActive]="i === 0"
        (onSwipe)="handleSwipe($event)"
        [style.z-index]="visibleProfiles.length - i">
      </app-swipe-card>
    </ng-container>
  </div>

  <!-- No Profiles Message -->
  <ng-template #noProfiles>
    <div class="no-profiles">
      <ion-icon name="heart-dislike-outline" class="no-profiles-icon"></ion-icon>
      <h2>No hay más perfiles</h2>
      <p>¡Vuelve más tarde para ver nuevos perfiles!</p>
      <ion-button fill="outline" (click)="refreshProfiles()">
        <ion-icon name="refresh-outline" slot="start"></ion-icon>
        Actualizar
      </ion-button>
    </div>
  </ng-template>

  <!-- Action Buttons -->
  <div class="action-buttons" *ngIf="profiles.length > 0">
    <ion-button 
      class="dislike-btn" 
      fill="solid" 
      color="light"
      (click)="dislike()">
      <ion-icon name="close" class="action-icon"></ion-icon>
    </ion-button>
    
    <ion-button 
      class="super-like-btn" 
      fill="solid" 
      color="primary"
      (click)="superLike()">
      <ion-icon name="star" class="action-icon"></ion-icon>
    </ion-button>
    
    <ion-button 
      class="like-btn" 
      fill="solid" 
      color="success"
      (click)="like()">
      <ion-icon name="heart" class="action-icon"></ion-icon>
    </ion-button>
  </div>

  <!-- Match Modal -->
  <ion-modal [isOpen]="showMatchModal" (didDismiss)="closeMatchModal()">
    <ng-template>
      <div class="match-modal">
        <div class="match-content">
          <h1 class="match-title">¡Es un Match!</h1>
          <div class="match-photos">
            <img [src]="currentUser?.photos?.[0] || 'assets/icon/default-avatar.png'" 
                 alt="Tu foto" class="match-photo">
            <div class="heart-icon">
              <ion-icon name="heart" color="danger"></ion-icon>
            </div>
            <img [src]="matchedUser?.photos?.[0] || 'assets/icon/default-avatar.png'" 
                 alt="Foto del match" class="match-photo">
          </div>
          <p class="match-message">
            A ti y a {{ matchedUser?.name }} se han gustado mutuamente
          </p>
          <div class="match-actions">
            <ion-button fill="outline" (click)="closeMatchModal()">
              Seguir viendo
            </ion-button>
            <ion-button fill="solid" (click)="goToChatWithMatch()">
              Enviar mensaje
            </ion-button>
          </div>
        </div>
      </div>
    </ng-template>
  </ion-modal>

</ion-content>
